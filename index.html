<!DOCTYPE html>
<html>
<head>
  <title>Weather</title>
  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  
  
  <link rel="stylesheet" type="text/css" href="css/main.css">
  <script src="js/script.js"></script>
  
  <script type="text/javascript">
    var auth = "";
	//var vart = "Sana,YE";
		  
	$(document).ready(function() {
		$("button").click(function() {
		

		
		
	getLocation();
		
		function getLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
    } else { 
        x.innerHTML = "Geolocation is not supported by this browser.";
    }
}

function showPosition(position) {
//https://api.aerisapi.com/observations/59.3133135, 18.0914279?client_id=2DLZxkOpvYq3SA8X4Ny4s&client_secret=h3ado5fV7TbT7RTvDsEnrat6hHBmCHHhypZFUPvM
	
	var la_ =  position.coords.latitude;
	var lo_= position.coords.longitude;
	
	//	 la_ =  59.3133135;
	//lo_= 18.0914279;
	 //console.log(la_+" "+lo_);
	loadWeatherData(la_, lo_);
	
}
	 
		});
		function loadWeatherData(lat, lon) {
 $.ajax({
        url: "https://api.aerisapi.com/observations/" + lat + "," + lon + "?client_id=2DLZxkOpvYq3SA8X4Ny4s&client_secret=h3ado5fV7TbT7RTvDsEnrat6hHBmCHHhypZFUPvM",
         //url: "https://api.aerisapi.com/observations/"+vart+"%20CA?client_id=2DLZxkOpvYq3SA8X4Ny4s&client_secret=h3ado5fV7TbT7RTvDsEnrat6hHBmCHHhypZFUPvM",
		 dataType: "jsonp",
         success: function(json) {
            if (json.success == true) {
               var ob = json.response.ob;
			 
			  var vader = ob.weather.toLowerCase();
			   getAuthor(vader);
		
			   
			   
               $('#hej').html(vader + ' with a temperature of ' + ob.tempC + '°' + ' ');
            }
            else {
               alert('An error occurred: ' + json.error.description);
            }
         }
      });
	  };
	  function getAuthor(vader){
	
	  			   if (vader.includes("clear" || "sunny" || "fair"))
			   auth = "August+Strindberg";
			   else if (vader.includes("mostly Clear" || "mostly sunnny"))
			   auth = "Karin+Boye";
			   else if (vader.includes("mostly cloudy"))
			    auth = "Stig+Dagerman";
				else 
				auth = "Kerstin+Ekman";
				 var f = "https://libris.kb.se/xsearch?query=Stig+Dagerman&n=10&format=json";
				  var f = "https://libris.kb.se/xsearch?query="+auth+"&n=10&format=json";
			$.getJSON(f, 
				function(data) {
		
					//$("#hej").append(data.xsearch.from);
					
				//	$.each(data.xsearch.list, function(i, obj) {
						/*var post = "<article>";
						post += "<h1>" + obj.title + "</h1>";
						post += "<p>" + obj.creator + "</p>";
						post += "<ul>";
						//for(var i in obj.tags)
						//{
							//post += "<li>" + obj.tags[i] + "</li>";
						//}
						post += "</ul>";
						post += "</article>";*/
						$("#blogposts").append(data.xsearch.list[0].title + " Av "+auth.replace("+", " "));
						
					//});
					
					
			});
			}
	});
	

	</script>
</head>
<body>
<div class="container">
<button type="button" class="btn btn-primary btn-lg">Test</button>
	<h3>Today when the current weather is</h3>
		<div id="hej"></div>
		<h3>Maybe this book could be nice to read:</h3>
		<div id="blogposts"></div>
			<div id="theDiv"></div>
</div>

<!-- <a href="svdTest.html">Nobelpris</a> -->
</body>
</html